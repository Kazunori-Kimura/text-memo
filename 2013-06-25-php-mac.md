---
layout: post
title: ZendFramework2設定 for Mac
date: 2013-06-25
category: php
tags: [php, ZendFramework2, Mac]
---

Zend Framework 2 開発環境構築 for Mac OS X
=========


環境確認
-----

Macには標準でhttpd(apache),phpがインストールされていますので、
そのまま使用したいと思います。

念のためそれぞれのバージョンを確認してください。

<br>
<br>

### httpdバージョン

`httpd -V` (Vは大文字)でコンパイルオプションを表示します。
Server version と SERVER_CONFIG_FILE で指定されているパスを
確認してください。

    $ httpd -V
    Server version: Apache/2.2.22 (Unix)
    Server built:   Dec  9 2012 18:57:18
    Server's Module Magic Number: 20051115:30
    Server loaded:  APR 1.4.5, APR-Util 1.3.12
    Compiled using: APR 1.4.5, APR-Util 1.3.12
    Architecture:   64-bit
    Server MPM:     Prefork
      threaded:     no
        forked:     yes (variable process count)
    Server compiled with....
     -D APACHE_MPM_DIR="server/mpm/prefork"
     -D APR_HAS_SENDFILE
     -D APR_HAS_MMAP
     -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)
     -D APR_USE_FLOCK_SERIALIZE
     -D APR_USE_PTHREAD_SERIALIZE
     -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT
     -D APR_HAS_OTHER_CHILD
     -D AP_HAVE_RELIABLE_PIPED_LOGS
     -D DYNAMIC_MODULE_LIMIT=128
     -D HTTPD_ROOT="/usr"
     -D SUEXEC_BIN="/usr/bin/suexec"
     -D DEFAULT_PIDLOG="/private/var/run/httpd.pid"
     -D DEFAULT_SCOREBOARD="logs/apache_runtime_status"
     -D DEFAULT_LOCKFILE="/private/var/run/accept.lock"
     -D DEFAULT_ERRORLOG="logs/error_log"
     -D AP_TYPES_CONFIG_FILE="/private/etc/apache2/mime.types"
     -D SERVER_CONFIG_FILE="/private/etc/apache2/httpd.conf"


<br>

### PHPバージョン


    $ php -v
    PHP 5.3.15 with Suhosin-Patch (cli) (built: Dec  9 2012 19:32:02) 
    Copyright (c) 1997-2012 The PHP Group
    Zend Engine v2.3.0, Copyright (c) 1998-2012 Zend Technologies


<br>

httpdでphpを有効にする
------

### httpd.conf設定

[PHPマニュアル - バンドルされている PHP の使用法](http://php.net/manual/ja/install.macosx.bundled.php)

<br>

`/private/etc/apache2/httpd.conf`をテキストエディタで開き、
モジュールの読み込み箇所のコメントを外します。

`sudo vim /private/etc/apache2/httpd.conf`

    # LoadModule php5_module libexec/httpd/libphp5.so
    LoadModule php5_module libexec/httpd/libphp5.so


<br>
<br>

### 動作確認

PHPが動作することを確認します。

DocumentRootにphpinfoを配置します。
標準のDocumentRootは`/Library/WebServer/Documents`です。

    <?php phpinfo() ?>

Apacheを起動します。

    $ sudo httpd -k start
    httpd: Could not reliably determine the server's fully qualified domain name, using Kimura-no-MacBook-Air.local for ServerName

FQDN(fully qualified domain name)が設定されていない警告が表示されますが
特に問題なくApacheは起動しています。

ブラウザを起動して `http://localhost/phpinfo.php` にアクセスします。

PHPのバージョン情報が表示されることを確認し、Apacheを停止します。

    $ sudo httpd -k stop

<br>

------

<br>

Zend Framework2
------

-[Zend Framework Latest Releases](http://framework.zend.com/downloads/latest)
-[ZendSkeletonApplication](https://github.com/zendframework/ZendSkeletonApplication)

<br>

### ファイルの展開

`/Users/<user_name>/zend`ディレクトリにそれぞれを展開することとします。
他のディレクトリで作業する場合は、各自パスを読み替えてください。

    $ tar xzf ZendFramework-2.2.1.tgz
    $ mv ZendFramework-2.2.1 ~/zend/
    $ unzip ZendSkeletonApplication-master.zip
    $ mv ZendSkeletonApplication-master ~/zend/sample_app

<br>

### php.ini設定

標準では`/etc/php.ini`は存在しませんが、`/etc/php.ini.default`という
ファイルがあるので、コピーして使用します。

    $ sudo cp /etc/php.ini.default /etc/php.ini
    $ sudo chmod +w /etc/php.ini
    $ sudo vim /etc/php.ini


`/etc/php.ini` 795行目付近

    ; UNIX: "/path1:/path2"
    ;include_path = ".:/php/includes"
    include_path = ".:/Users/kimurakazunori/zend/ZendFramework-2.2.1/library"


<br>

### VirtualHost設定

`sudo vim /private/etc/apache2/other/vhost.conf`

    NameVirtualHost *:80

    <VirtualHost *:80>
        DocumentRoot "/Users/kimurakazunori/zend/sample_app/public"
        ServerName sample.localhost
        SetEnv ZF2_PATH "/Users/kimurakazunori/zend/ZendFramework-2.2.1/library"
        <Directory "/Users/kimurakazunori/zend/sample_app/public">
            DirectoryIndex index.php
            AllowOverride All
            #Require all granted
            Order allow,deny
            Allow from all
        </Directory>
    </VirtualHost>

    <VirtualHost *:80>
        DocumentRoot "/Library/WebServer/Documents"
        ServerName localhost
        <Directory "/Library/WebServer/Documents">
            Options Indexes FollowSymLinks Includes ExecCGI
            AllowOverride All
            #Require all granted
            Order allow,deny
            Allow from all
        </Directory>
    </VirtualHost>

<br>

### hosts設定

`sudo vim /etc/hosts`

    127.0.0.1	localhost sample.localhost

<br>

### 動作確認

    $ sudo httpd -k start

ブラウザで`http://sample.localhost`に接続します。
ZendFrameworkのページが表示されることを確認します。


<br>
<br>





